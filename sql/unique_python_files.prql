prql target:sql.duckdb

let any_value = column -> s"any_value({column})"

from (read_parquet $1)
filter path ~= "\\.py$"
filter skip_reason == ""
select {hash, path}
group {hash} (
aggregate {
  path = any_value(path)
})
sort {hash}