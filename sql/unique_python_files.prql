prql target:sql.duckdb

from (read_parquet $1)
filter s"suffix({path}, '.py')"
filter skip_reason == ""
group {hash} (
  sort {uploaded_on}
  take 1
  select {hash, path, repository, uploaded_on}
)
select {hash, path, uploaded_on} | sort {path}
